# this config enables the handling of Moonstalk using en embedded OpenResty environment
# the processing order is location =; the longest location ^~ static prefix match; otherwise the longest location ~ regex

fastcgi_temp_path temporary/nginx/fastcgi;
proxy_temp_path temporary/nginx/proxy;
scgi_temp_path temporary/nginx/scgi;
uwsgi_temp_path temporary/nginx/uwsgi;

lua_socket_read_timeout 60s; # TODO: apparently the default has not been applied thus needs setting explictly

# the following match assets for applications efficiently, thus application assets are preferred; generated by runner
include applications.conf;

location ^~ /tenants/ {
	# static content shared across all domains
	root public/;
	break;
}

location ^~ /users/ {
	# static content shared across all domains
	root public/;
	break;
}

location ^~ /private/ {
	return 404;
	break;
}
